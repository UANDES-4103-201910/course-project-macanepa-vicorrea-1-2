<!DOCTYPE html>
<html>
  <head>
    <title>AngryLusho</title>
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <link rel='stylesheet' href='https://use.fontawesome.com/releases/v5.7.0/css/all.css' integrity='sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ' crossorigin='anonymous'>
    <%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %>
  </head>
  <body>
  <% if(user_signed_in? && current_user.profile.nil?) %>
    <%# redirect_to session_sign_up_path  %>
  <% end %>
  <nav id="navbar-app" class="navbar navbar-expand-lg bg-light justify-content-between fixed-top">
    <a class="navbar-brand" href="<%= root_path %>">AngryLusho <% if user_signed_in? && current_user.is_admin %><small>admin</small> <% end %></a>
    <form class="form-inline" action=<%=search_path %> >




      <input class="form-control mr-sm-2" type="search" placeholder="Search..." aria-label="Search" name="input">

      <select class="form-control mr-sm-2" name="search_by">
        <option class="form-control" value="name">Name</option>
        <option class="form-control" value="location">Location</option>
      </select>

      <button class="btn btn-primary" type="submit">Search</button>


    </form>
    <div class="nav-item">
      <form class="form-inline">
        <% if user_signed_in? && current_user.is_admin %>
          <a href="<%= admin_view_path %>" class="btn btn-outline-dark mr-2" role="button">Admin</a>
        <% end %>
        <% if user_signed_in? && (not current_user.profile.nil?) %>
          <div class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">

              <% if not current_user.profile.image.attached? %>
                <img src="https://abs.twimg.com/sticky/default_profile_images/default_profile_normal.png" class="my-auto mx-4 rounded-circle border border-primary">
              <% else %>
                <%= image_tag current_user.profile.image.variant(combine_options: {resize:'100x100', gravity: "Center", crop: '50x50+0+0' }), :class => "my-auto mx-4 rounded-circle border border-primary"%>
              <% end %>

            </a>
            <div class="dropdown-menu dropdown-menu-right">
              <div class="dropdown-item">
                <h6><%=current_user.name %><br>
                  <small><%=current_user.email %></small>
                </h6>
              </div>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item" href="<%= user_profile_view_path(user_profile_id: current_user.profile.id) %>">View profile</a>
              <%= link_to "Log out", destroy_user_session_path, method: :delete %>
            </div>
          </div>
        <% elsif user_signed_in? && current_user.profile.nil? %>
          <div class="nav-item">
            <form class="form-inline">
<!--              <p><%#= current_user.name %></p>-->
<!--              <a href="<%#= session_sign_up_path %>" class="btn btn-outline-primary" role="button">Create Profile</a>-->
              <%= link_to "Log out", destroy_user_session_path, method: :delete %>
            </form>
          </div>
        <% else %>
            <form class="form-inline">
<!--              <a href="<%#= session_login_path %>" class="btn btn-outline-primary" role="button">Log in</a>-->
              <a href="<%= new_user_session_path %>" class="btn btn-outline-primary" role="button">Log in</a>
<!--              <a href="<%#= session_sign_up_path %>" class="btn btn-outline-primary ml-2" role="button">Sign Up</a>-->
              <a href="<%= new_user_registration_path %>" class="btn btn-outline-primary ml-2" role="button">Sign Up</a>
            </form>
        <% end %>
      </form>
    </div>
  </nav>

 <div id="page-app" class="page-content">
   <% if notice %>
     <div id="notice" class="alert alert-success alert-dismissible fade show">
       <button type="button" class="close" data-dismiss="alert">&times;</button>
       <%= notice %>
     </div>
   <% end %>
   <% if alert %>
     <div id="alert" class="alert alert-danger alert-dismissible fade show">
       <button type="button" class="close" data-dismiss="alert">&times;</button>
       <%= alert %>
     </div>
   <% end %>
    <%= yield %>
    </div>
  <footer id="footer-app">
    <nav class="navbar navbar-expand-lg bg-light justify-content-end">
      <div class="nav-item">
        <a class="nav-link text-primary" data-toggle="modal" data-target="#aup-modal">Acceptable Use Policy</a>
      </div>
      <div class="nav-item">
        <a class="nav-link text-primary" data-toggle="modal" data-target="#tos-modal">Terms of Service</a>
      </div>
    </nav>
  </footer>
  </body>
</html>
<div class="modal" id="tos-modal">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Term of Service</h4>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>
      <div class="modal-body" id="remove-from-dumpster-modal-body">
        <p>Content of TOS.</p>
      </div>
    </div>
  </div>
</div>
<div class="modal" id="aup-modal">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Acceptable Use Policy</h4>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>
      <div class="modal-body" id="remove-from-dumpster-modal-body">
        <p>Content of AUP.</p>
      </div>
    </div>
  </div>
</div>
